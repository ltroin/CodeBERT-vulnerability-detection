import json

# Store the processed items in a list
processed_data = []

# 1. Load the JSON file line by line
with open('merged_devign.json', 'r') as file:
    for line in file:
        item = json.loads(line.strip())

        # Apply the transformations
        if 'label' in item:
            item['target'] = item.pop('label')  # rename 'label' to 'target'
        
        if 'id' in item:
            item['idx'] = item.pop('id')  # rename 'id' to 'idx'
        
        if 'func1' in item:
            item['func'] = item.pop('func1')  # rename 'func1' to 'func'
        
        processed_data.append(item)

# 3. Save the modified data back to a new JSON file
with open('modified_merged_devign.json', 'w') as file:
    for item in processed_data:
        json.dump(item, file)
        file.write("\n")  # Write each JSON object in a new line
